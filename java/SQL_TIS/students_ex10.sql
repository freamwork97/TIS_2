-- 학생테이블 생성
CREATE TABLE STUDENTS(
    SCODE CHAR(6) NOT NULL PRIMARY KEY,
    SNAME VARCHAR(20) NOT NULL,
    DEPT VARCHAR(20) NOT NULL
);

-- 과목테이블 생성
CREATE TABLE COURSES(
    CCODE CHAR(3) NOT NULL PRIMARY KEY,
    CNAME VARCHAR(100) NOT NULL
);

-- 수강신청테이블 생성
CREATE TABLE ENROLS(
    SCODE CHAR(6) NOT NULL,
    CCODE CHAR(3) NOT NULL,
    GRADE INT DEFAULT 0,
    EDATE DATE DEFAULT SYSDATE,
    PRIMARY KEY(SCODE,CCODE),
    FOREIGN KEY(SCODE) REFERENCES STUDENTS(SCODE),
    FOREIGN KEY(CCODE) REFERENCES COURSES(CCODE)
);

INSERT INTO STUDENTS(SCODE, SNAME,DEPT)
VALUES('202301','홍길동','컴정');
INSERT INTO STUDENTS(SCODE, SNAME,DEPT)
VALUES('202302','심청이','컴정');
INSERT INTO STUDENTS(SCODE, SNAME,DEPT)
VALUES('202303','이순신','컴정');

SELECT * from STUDENTS;

INSERT INTO COURSES(CCODE, CNAME)
VALUES('100','자바');
INSERT INTO COURSES(CCODE, CNAME)
VALUES('101','데이터베이스');
INSERT INTO COURSES(CCODE, CNAME)
VALUES('102','HTML');

SELECT * from COURSES;

INSERT INTO ENROLS(SCODE,CCODE)
VALUES('202301','100');
INSERT INTO ENROLS(SCODE,CCODE)
VALUES('202301','102');
INSERT INTO ENROLS(SCODE,CCODE)
VALUES('202302','101');
INSERT INTO ENROLS(SCODE,CCODE)
VALUES('202302','102');
INSERT INTO ENROLS(SCODE,CCODE)
VALUES('202303','102');
SELECT * FROM enrols;

-- 뷰생성
CREATE VIEW VIEW_ENROLS AS
SELECT E.*, S.SNAME, C.CNAME
FROM STUDENTS S, COURSES C, ENROLS E
WHERE E.SCODE=s.SCODE and c.CCODE=e.CCODE;

SELECT * FROM view_enrols order by SCODE;

commit;

SELECT max(SCODE)+1 NCODE FROM STUDENTS;

SELECT * FROM VIEW_ENROLS WHERE SCODE='202302';
SELECT * FROM VIEW_ENROLS WHERE CCODE='102';
SELECT * FROM VIEW_ENROLS;
Select * FROM view_enrols WHERE scode='202301' and ccode=102;
